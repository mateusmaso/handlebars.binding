// handlebars.binding
// ------------------
// v0.1.3
//
// Copyright (c) 2013-2015 Mateus Maso
// Distributed under MIT license
//
// http://github.com/mateusmaso/handlebars.binding

!function(a,b){"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(module.exports=b(global.Handlebars)),exports=b(global.Handlebars)):b(a.Handlebars)}(this,function(a){var b=a.Utils,c=function(a){return"<hb-binding id='"+a+"'></hb-binding>"},d=function(a){return"hb-binding-"+a};a.Utils.isFalsy=function(a){return!a||b.isEmpty(a)},a.Utils.hasClass=function(a,b){return a.className.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))},a.Utils.addClass=function(a,c){return b.hasClass(a,c)?void 0:0==a.className.length?a.className=c:a.className+=" "+c},a.Utils.removeClass=function(a,c){return b.hasClass(a,c)?a.className=a.className.replace(new RegExp("(\\s|^)"+c+"(\\s|$)"),""):void 0},a.Utils.removeBetween=function(a,b){for(var c=a.nextSibling;c&&c!=b;){var d=c.nextSibling;c.remove(),c=d}},a.Utils.path=function(a,b){for(var c=b.split("."),d=a[c.shift()],e=0;e<c.length;e++)d=d[c[e]];return d},a.registerHelper("bind",function(e,f){var g,h,i,j,k,l=document.createTextNode(""),m=document.createTextNode(""),n=b.path(this,e),o=b.uniqueId(),p=this,q=function(){try{f.hash.attr?1==f.hash.attr?(g.removeAttribute(k),g.setAttribute(n,"")):"class"==f.hash.attr?(b.removeClass(g,k),b.addClass(g,n)):g.setAttribute(f.hash.attr,n):f.fn?(h=a.parseHTML(f.fn(p)),b.removeBetween(m,l),b.insertAfter(m,h)):g.textContent=b.escapeExpression(b.isString(n)?new a.SafeString(n):n)}catch(c){i.close()}};return b.isArray(n)?(i=new ArrayObserver(n),i.open(function(){q()})):b.isObject(n)?(i=new ObjectObserver(n),i.open(function(){q()})):(i=new PathObserver(p,e),i.open(function(a){k=n,n=a,q()})),f.hash.attr?(a.registerAttribute("binding-"+o,function(a){return 1==f.hash.attr?j=document.createAttribute(n):"class"!=f.hash.attr?(j=document.createAttribute(f.hash.attr),j.value=n,j):(j=a.attributes.class,void b.addClass(a,n))},{ready:function(a){g=a}}),d(o)):f.fn?(h=a.parseHTML(f.fn(this)),a.store.hold(o,b.flatten([m,h,l])),new a.SafeString(c(o))):(g=document.createTextNode(b.isString(n)?b.escapeExpression(new a.SafeString(n)):b.escapeExpression(n)),a.store.hold(o,b.flatten([g])),new a.SafeString(c(o)))}),a.registerHelper("if",function(e,f){var g,h,i,j,k,l,m,n,o=document.createTextNode(""),p=document.createTextNode(""),q=b.uniqueId(),r=this,s=function(){return l?f.inverse?f.inverse(r):f.hash.else:f.fn?f.fn(r):f.hash.then},t=function(){try{f.hash.attr?1==f.hash.attr?(g.removeAttribute(n),m&&g.setAttribute(m,"")):"class"==f.hash.attr?(b.removeClass(g,n),m&&b.addClass(g,m)):g.setAttribute(f.hash.attr,m):f.fn?(h=a.parseHTML(m),b.removeBetween(p,o),b.insertAfter(p,h)):g.textContent=b.escapeExpression(b.isString(m)?new a.SafeString(m):m)}catch(c){i.close()}};return f.hash.bindAttr&&(f.hash.attr=f.hash.bindAttr,f.hash.bind=!0),f.hash.bind&&b.isString(e)&&(k=e,e=b.path(this,k)),l=b.isFalsy(e),m=s(),f.hash.bind?(b.isArray(e)?(i=new ArrayObserver(e),i.open(function(){b.isFalsy(e)!=l&&(l=b.isFalsy(e),n=m,m=s(),t())})):(i=new PathObserver(r,k),i.open(function(a){e=a,b.isFalsy(e)!=l&&(l=b.isFalsy(e),n=m,m=s(),t())})),f.hash.attr?(a.registerAttribute("binding-"+q,function(a){if(1==f.hash.attr){if(m&&(j=document.createAttribute(m)),j)return j}else{if("class"!=f.hash.attr)return j=document.createAttribute(f.hash.attr),j.value=m,j;j=a.attributes.class,m&&b.addClass(a,m)}},{ready:function(a){g=a}}),d(q)):f.fn?(h=a.parseHTML(m),a.store.hold(q,b.flatten([p,h,o])),new a.SafeString(c(q))):(g=document.createTextNode(b.isString(m)?b.escapeExpression(new a.SafeString(m)):b.escapeExpression(m)),a.store.hold(q,b.flatten([g])),new a.SafeString(c(q)))):m}),a.registerHelper("unless",function(b,c){var d=c.fn,e=c.inverse,f=c.hash.then,g=c.hash.else;return c.fn=e,c.inverse=d,c.hash.then=g,c.hash.else=f,a.helpers["if"].apply(this,[b,c])}),a.registerHelper("each",function(d,e){var f,g,h=document.createTextNode(""),i=document.createTextNode(""),j=0==d.length,k=b.uniqueId(),l=this,m=[],n=[],o=[],p=function(){g="";for(var a=0;a<d.length;a++)g+=q(d[a],a);return d.length?g:e.inverse(l)},q=function(a,c){var d=b.extend({index:c},l),f=new ObjectObserver(l);return f.open(function(){d=b.extend(d,l)}),e.hash.var?d[e.hash.var]=a:d=b.extend(d,a),e.fn(d)},r=function(c){try{if(0!=d.length||j||(j=!0,g=p(),b.insertAfter(i,a.parseHTML(g))),d.length>0&&j&&(j=!1,b.removeBetween(i,h)),c.removed.length>0){for(var e=c.index;e<c.index+c.removed.length;e++)b.removeBetween(n[e],m[e]),n[e].remove(),m[e].remove();for(var e=c.index;e<c.index+c.removed.length;e++)n.splice(e,1),m.splice(e,1)}if(c.addedCount>0)for(var e=c.index;e<c.index+c.addedCount;e++){var k=d[e],l=document.createTextNode(""),o=document.createTextNode(""),r=a.parseHTML(q(k,e)),s=m[e-1]||i;b.insertAfter(s,b.flatten([l,r,o])),n.splice(e,0,l),m.splice(e,0,o)}}catch(t){f.close()}};if(g=p(),e.hash.bind){f=new ArrayObserver(d),f.open(function(a){for(var b=0;b<a.length;b++)r(a[b])});for(var s=0;s<d.length;s++){var t=d[s],u=document.createTextNode(""),v=document.createTextNode(""),w=a.parseHTML(q(t,s));n.push(u),m.push(v),o.push(u,w,v)}return o=b.flatten(o),a.store.hold(k,b.flatten([i,j?a.parseHTML(g):o,h])),new a.SafeString(c(k))}return g}),a.registerElement("binding",function(a){return a.id})});